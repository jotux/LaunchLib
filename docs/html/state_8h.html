<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>LaunchLib: state.h File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">LaunchLib
   
   </div>
   <div id="projectbrief">An easy-to-use library to help kickstart your launchpad development.</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.8.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('state_8h.html','');
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">state.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Definitions, data structues and prototypes for state machine handling.  
<a href="#details">More...</a></p>

<p><a href="state_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_transition.html">Transition</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A transition which holds a current state, an event, and the state that will be entered upon receieving that event.  <a href="struct_transition.html#details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr class="memitem:a5ab720e698e2cb8f94c83bdc6d89b31a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="state_8h.html#a5ab720e698e2cb8f94c83bdc6d89b31a">DEFAULT_EVENTS</a>&#160;&#160;&#160;<a class="el" href="state_8c.html#a6e06d4f4914d3d22da439a47a8fa4675afd6a0e4343048b10646dd2976cc5ad18">IDLE</a>,<a class="el" href="state_8c.html#a6e06d4f4914d3d22da439a47a8fa4675a951ab68bb8f7daafb78951107080904e">ENTER</a>,<a class="el" href="state_8c.html#a6e06d4f4914d3d22da439a47a8fa4675a7a10b5d68d31711288e1fe0fa17dbf4f">EXIT</a></td></tr>
<tr class="memdesc:a5ab720e698e2cb8f94c83bdc6d89b31a"><td class="mdescLeft">&#160;</td><td class="mdescRight">List of default events.  <a href="#a5ab720e698e2cb8f94c83bdc6d89b31a"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a73296dcaec5ad45548632021a1e68528"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="state_8h.html#a73296dcaec5ad45548632021a1e68528">State</a> )(<a class="el" href="global_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>)</td></tr>
<tr class="memdesc:a73296dcaec5ad45548632021a1e68528"><td class="mdescLeft">&#160;</td><td class="mdescRight">function pointer to a state function that accepts an event variable  <a href="#a73296dcaec5ad45548632021a1e68528"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a33dc29df01532e875f3bc38f0dd3bfda"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="state_8h.html#a33dc29df01532e875f3bc38f0dd3bfda">StateMachineInit</a> (<a class="el" href="struct_transition.html">Transition</a> *state_transitions, <a class="el" href="global_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> t_size)</td></tr>
<tr class="memdesc:a33dc29df01532e875f3bc38f0dd3bfda"><td class="mdescLeft">&#160;</td><td class="mdescRight">State machine initialization.  <a href="#a33dc29df01532e875f3bc38f0dd3bfda"></a><br/></td></tr>
<tr class="memitem:a19551ac60bc7944766db81ffac45e282"><td class="memItemLeft" align="right" valign="top"><a class="el" href="global_8h.html#aef44329758059c91c76d334e8fc09700">int8_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="state_8h.html#a19551ac60bc7944766db81ffac45e282">StateMachinePublishEvent</a> (<a class="el" href="global_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> event)</td></tr>
<tr class="memdesc:a19551ac60bc7944766db81ffac45e282"><td class="mdescLeft">&#160;</td><td class="mdescRight">Queue a new event.  <a href="#a19551ac60bc7944766db81ffac45e282"></a><br/></td></tr>
<tr class="memitem:a940f2f18dae4f0f2c0fca4a02444c3d9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="state_8h.html#a940f2f18dae4f0f2c0fca4a02444c3d9">StateMachineRun</a> (<a class="el" href="state_8h.html#a73296dcaec5ad45548632021a1e68528">State</a> *state)</td></tr>
<tr class="memdesc:a940f2f18dae4f0f2c0fca4a02444c3d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run the state machine.  <a href="#a940f2f18dae4f0f2c0fca4a02444c3d9"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Definitions, data structues and prototypes for state machine handling. </p>
<dl class="section author"><dt>Author:</dt><dd>Joe Brown </dd></dl>

<p>Definition in file <a class="el" href="state_8h_source.html">state.h</a>.</p>
</div><hr/><h2>Define Documentation</h2>
<a class="anchor" id="a5ab720e698e2cb8f94c83bdc6d89b31a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="state_8h.html#a5ab720e698e2cb8f94c83bdc6d89b31a">DEFAULT_EVENTS</a>&#160;&#160;&#160;<a class="el" href="state_8c.html#a6e06d4f4914d3d22da439a47a8fa4675afd6a0e4343048b10646dd2976cc5ad18">IDLE</a>,<a class="el" href="state_8c.html#a6e06d4f4914d3d22da439a47a8fa4675a951ab68bb8f7daafb78951107080904e">ENTER</a>,<a class="el" href="state_8c.html#a6e06d4f4914d3d22da439a47a8fa4675a7a10b5d68d31711288e1fe0fa17dbf4f">EXIT</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>List of default events. </p>

<p>Definition at line <a class="el" href="state_8h_source.html#l00015">15</a> of file <a class="el" href="state_8h_source.html">state.h</a>.</p>

</div>
</div>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="a73296dcaec5ad45548632021a1e68528"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* <a class="el" href="state_8h.html#a73296dcaec5ad45548632021a1e68528">State</a>)(<a class="el" href="global_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>function pointer to a state function that accepts an event variable </p>

<p>Definition at line <a class="el" href="state_8h_source.html#l00011">11</a> of file <a class="el" href="state_8h_source.html">state.h</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a33dc29df01532e875f3bc38f0dd3bfda"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="state_8h.html#a33dc29df01532e875f3bc38f0dd3bfda">StateMachineInit</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_transition.html">Transition</a> *&#160;</td>
          <td class="paramname"><em>state_transitions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="global_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td>
          <td class="paramname"><em>t_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>State machine initialization. </p>
<p>Initializes the state machine by saving a pointer to the transition rules, saving the size (so we can loop through it looking for state changes) and initially publishes and ENTER event so the first state can initialize whatever it needs. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">state_transitions</td><td>Pointer to state transitions rules table </td></tr>
    <tr><td class="paramname">t_size</td><td>The size of the transition rules table (not accounting for <a class="el" href="struct_transition.html" title="A transition which holds a current state, an event, and the state that will be entered upon receievin...">Transition</a> struct size) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="state_8c_source.html#l00038">38</a> of file <a class="el" href="state_8c_source.html">state.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// save a pointer to the state transition table</span>
    transition_table = state_transitions;
    <span class="comment">// save it&#39;s size so we can search it</span>
    transition_table_size = (t_size / <span class="keyword">sizeof</span>(<a class="code" href="struct_transition.html" title="A transition which holds a current state, an event, and the state that will be entered upon receievin...">Transition</a>));
    <span class="comment">// enqueue an enter event to start the idle state</span>
    <a class="code" href="state_8c.html#a19551ac60bc7944766db81ffac45e282" title="Queue a new event.">StateMachinePublishEvent</a>(<a class="code" href="state_8c.html#a6e06d4f4914d3d22da439a47a8fa4675a951ab68bb8f7daafb78951107080904e">ENTER</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a19551ac60bc7944766db81ffac45e282"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="global_8h.html#aef44329758059c91c76d334e8fc09700">int8_t</a> <a class="el" href="state_8h.html#a19551ac60bc7944766db81ffac45e282">StateMachinePublishEvent</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="global_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td>
          <td class="paramname"><em>event</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Queue a new event. </p>
<p>Pushes a new event in to the event queue and adjust the size. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">event</td><td>The event to enqueue. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>0 if successful, -1 for failure </dd></dl>

<p>Definition at line <a class="el" href="state_8c_source.html#l00092">92</a> of file <a class="el" href="state_8c_source.html">state.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="global_8h.html#aef44329758059c91c76d334e8fc09700">int8_t</a> ret = -1;
    <span class="comment">// event queue full?</span>
    <span class="keywordflow">if</span> (size &lt; <a class="code" href="hardware_8h.html#a4ca719fc38491bd0082e84b9e5dbe778">MAX_EVENT_CNT</a>)
    {
        <span class="comment">// add event to queue</span>
        queue[((start + size) == <a class="code" href="hardware_8h.html#a4ca719fc38491bd0082e84b9e5dbe778">MAX_EVENT_CNT</a>) ? 0 : (start + size)] = event;
        <span class="comment">// adjust the size</span>
        size++;
        <span class="comment">// return success</span>
        ret = 0;
    }
    <span class="keywordflow">return</span> ret;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a940f2f18dae4f0f2c0fca4a02444c3d9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="state_8h.html#a940f2f18dae4f0f2c0fca4a02444c3d9">StateMachineRun</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="state_8h.html#a73296dcaec5ad45548632021a1e68528">State</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Run the state machine. </p>
<p>Checks the event queue for new events, processes the current state and modifies the state based on state transitions. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">state</td><td>A pointer to the current state </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns:</dt><dd>Overwrites current state pointer with next state pointer </dd></dl>

<p>Definition at line <a class="el" href="state_8c_source.html#l00148">148</a> of file <a class="el" href="state_8c_source.html">state.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// get the next event</span>
    <a class="code" href="global_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <span class="keyword">event</span> = <a class="code" href="state_8c.html#aed24699fb62cd4dac6111cc46be93bfb" title="Check the event queue for changes.">CheckEventQueue</a>(*state);
    <span class="comment">// run the state</span>
    (*state)(event);
    <span class="comment">// check for state transitions</span>
    *state = <a class="code" href="state_8c.html#a1cdba4fcc4f2957df1b8076501feec84" title="Get the next state from the transition table.">LookupTransition</a>(*state, event);
}
</pre></div>
</div>
</div>
</div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="state_8h.html">state.h</a>      </li>

    <li class="footer">Generated on Wed Apr 11 2012 23:43:44 for LaunchLib by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.0 </li>
   </ul>
 </div>


</body>
</html>
